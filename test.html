<!-- Inside index.html -->
<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<meta content=
		"This is a demo of Web integration
		of Razorpay in NodeJS"
		author="Mr. Twinkle Sharma" />
	<title>Razorpay Web-Integration</title>
</head>

<body>
	<hr/>
	<h2>Advanced Data Structures & Algorithms Course</h2>
	<h3>Description</h3>

	<ul>
		<li>Best Course for SDE placements</li>
		<li>
			Available in 4 major Languages JAVA,
			C/C++, Python, Javascript
		</li>
		<li>Lifetime Access</li>
	</ul>

	<span> Cost:- 499 Rupees
		<button id="pay-button" >
			Pay Now & Get Access
		</button>
	</span>
	<hr/>

	<!-- Processing Payment Checkout -->
	<!-- We will write code for payment here,
		Replace this comment with the code we
		are explaining below in step 5 of the
		article -->

		<!--Inside index.html -->
		<button id="rzp-button1">Pay with Razorpay</button>
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<script>
	  console.log("Adf2")

	$(document).ready(function() {
	  var orderId;
	  console.log("Adf")
	
	  var settings = {
		url: "http://localhost:8000/create-order",
		method: "GET",
		timeout: 0,
		headers: {
		  "Content-Type": "application/json",
		},
		data: JSON.stringify({
		  amount: "50000",
		}),
	  };
	
	  // Create new orderId every time
	  $.ajax(settings).done(function(response) {
		orderId = response.id;
		console.log("orderId");
		$("#rzp-button1").show();
	  });
	
	  document.getElementById("rzp-button1").onclick = function(e) {
		console.log("OrderId")
		alert(orderId)
		var options = {
		  key: "rzp_test_0T6HwJRA4sjbOV",
		  amount: "50000",
		  currency: "INR",
		  name: "Nikhil",
		  description: "Buy subscription",
		  image: "https://example.com/your_logo",
		  order_id: orderId,
		  handler: function(response) {
			console.log(response); // Log the entire response object to inspect its structure
			console.log(response.razorpay_payment_id);
			console.log(response.razorpay_order_id);
			console.log(response.razorpay_signature);
			alert(response.razorpay_payment_id);
			alert(response.razorpay_order_id);
			alert(response.razorpay_signature);

	
			var verifyData = {
			  response: response,
			};
	
			var verifySettings = {
			  url: "api/payment/verify",
			  method: "POST",
			  timeout: 0,
			  headers: {
				"Content-Type": "application/json",
			  },
			  data: JSON.stringify(verifyData),
			};
	
			$.ajax(verifySettings).done(function(verifyResponse) {
			  // Handle the response after verifying the payment
			});
		  },
		  theme: {
			color: "#99cc33",
		  },
		};
	
		var rzp1 = new Razorpay(options);
		rzp1.on("payment.failed", function(response) {
		  alert(response.error.code);
		  alert(response.error.description);
		  alert(response.error.source);
		  alert(response.error.step);
		  alert(response.error.reason);
		  alert(response.error.metadata.order_id);
		  alert(response.error.metadata.payment_id);
		});
	
		rzp1.open();
		e.preventDefault();
	  };
	});
	</script>


</body>


</html>
